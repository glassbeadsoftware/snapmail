<!doctype html>
<html lang="en">
<head>
<link rel="stylesheet" href="networking.css">
<div class="wrapper">
    <div class="box">
        <h1>Network status</h1>
        <button onclick=exitScreen()>Close</button>
    </div>
</div>
</head>

<body>
<!-- Peers -->
<div class="activity-message" id="peers">
    Peer count
</div>
<div class="activity-message" style="margin-left:30px;" id="peer-count">0</div>

<div></div>
<br/>

<!-- Bootstrap / mdns -->
<div class="activity-message" id="bootstrap-url">
    Checking bootstrap server...
</div>
<div class="activity-message" style="margin-left:30px;" id="bootstrap-status"></div>

<div></div>
<br/>

<!-- PROXY -->
<div class="activity-message" id="proxy-url">
    Checking proxy server...
</div>
<div class="activity-message" style="margin-left:30px;" id="proxy-status"></div>

<script>
  const ipc = require('electron').ipcRenderer;
  const bootstrapEl = document.getElementById('bootstrap-url')
  const bootStatusEl = document.getElementById('bootstrap-status')

  const proxyEl = document.getElementById('proxy-url')
  const proxyStatusEl = document.getElementById('proxy-status')

  const peerCountEl = document.getElementById('peer-count')

  ipc.on('networkInfoReply', (event, canMdns, canProxy, proxyUrl, peerCount) => {
    peerCountEl.innerHTML = peerCount
    if (canMdns) {
      bootstrapEl.innerHTML = "Using MDNS"
    } else {
      ipc.send('bootstrapStatus');
    }
    if (canProxy) {
      proxyEl.innerHTML = proxyUrl
      // proxyStatusEl.innerHTML = status? 'OK' : 'Not responding'
    } else {
      proxyEl.innerHTML = 'No proxy used'
    }
  })

  ipc.on('bootstrapStatusReply', (event, url, status) => {
    bootstrapEl.innerHTML = url
    bootStatusEl.innerHTML = status? 'OK' : 'Not responding'
  })
  let reply = ipc.send('networkInfo');
  //console.log(reply);

  function exitScreen() {
    ipc.send('exitNetworkStatus');
  }


</script>
</body>
</html>
